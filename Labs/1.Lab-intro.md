# Class Inheritance 

## Inheritance

- Inheritance ทำให้เราสามารถสร้าง class ใหม่ เพื่อขยายความสามารถของคลาสที่มีอยู่ โดยใช้คลาสที่มีอยู่เป็น Base class
- เมื่อทำการ inheritance มาแล้ว จะได้คลาสที่เรียกว่า Derived class
- ใน Derived class สามารถเข้าถึงสมาชิกได้ทั้งของ Base class และของตัวมันเอง : ขึ้นอยู่กับการกำหนดระดับการเข้าถึง (access level) ใน base class ด้วย

- อาจพูดได้ว่า derived class คือส่วนขยายของ base class
- อย่างไรก็ตาม derived class ไม่สามารถขจัดสิ่งที่ base class นิยามไว้

<img src="./pictures/picture_1.png" width= 480>



## UML DIAGRAM

<img src="./pictures/picture_2.png" width= 480>

## Conceptual Diagram

<img src="./pictures/picture_3.png" width= 480>

## Accessing the Inherited Members 

<img src="./pictures/picture_4.png" width= 480>

<img src="./pictures/picture_5.png" width= 480>

## ทุกๆ คลาส Derived จากคลาส object 

<img src="./pictures/picture_6.png" width= 480>

## การทำ Inheritance

เราสามารถทำ inheritance ได้จาก base class เพียงตัวเดียวเท่านั้น (เรียกว่า single inheritance)
แต่การทำ inheritence ในภาษา C# นั้น ทำได้ไม่จำกัดจำนวนชั้น



<img src="./pictures/picture_7.png" width= 480>

Inheritance Hierachy

<img src="./pictures/picture_8.png" width= 480>

## Masking Members of a Base Class 

- derived class ไม่สามารถลบความสามารถของ base class
แต่สามารถปิดบัง (mask) การกระทำได้ 
   - โดยการสร้าง field ที่มีชื่อเดียวกันกับ field ของ base class
   - โดยการสร้าง method ที่มี signature เดียวกันกับ method ของ base class
   - โดยการใช้ modifier “new”
- เราสามารถปิดบังสมาชิกที่เป็น static ได้ด้วย

## Masking Members of a Base Class 

<img src="./pictures/picture_9.png" width= 480>


<img src="./pictures/picture_10.png" width= 480>

## Hiding a field and a method of the base class

<img src="./pictures/picture_11.png" width= 480>


<img src="./pictures/picture_12.png" width= 480>



<img src="./pictures/picture_13.png" width= 480>

## Base Access 

- ในบางกรณี เราซ่อน Field หรือ Method ของ base class ไว้แล้ว แต่ด้วยวัตถุประสงค์บางประการ เราต้องการเข้าถึงมัน จะทำได้อย่างไร
- เราสามารถทำได้ด้วยการใส่ keyword “base” หน้าชื่อ Field ของ base class ที่ต้องการ

 









- ในการพัฒนาโปรแกรมจริง ถ้าพบว่าต้องใช้กรณีนี้บ่อยๆ ก็ต้องพิจารณาเรื่องการออกแบบแผนผังคลาสใน UML ว่าเหมาะสมหรือไม่ เพราะการออกแบบที่ดี ไม่ควรใช้งานในรูปแบบนี้บ่อยๆ



## Using References to a Base Class 

- วัตถุที่เราใช้งาน มักจะประกอบด้วยวัตถุที่สร้างจาก base class และ derived class ผสมปนเปกันอยู่
- การอ้างถึง derived class คือการอ้างถึงวัตถุก้อนใหญ่ ที่รวมเอาการอ้างถึงวัตถุของ base class ด้วย
- การที่จะอ้างถึงวัตถุของ base class เพียงอย่างเดียว ทำได้โดยการใช้ cast operator
- cast operator คือ การเขียน (class or type ) ไว้หน้า reference to object 

### ลำดับขั้นการใช้งาน


1. สร้าง reference และ object ของ derived class 
2. ประกาศ reference ของ base class
3. นำ reference ของ derived class มากำหนดให้ reference ของ base class ในข้อ 2 โดย casting ด้วยชื่อของ base class 

## Using References to a Base Class 





## Virtual and Override Methods 
- การใช้ reference ไปยัง base class มีข้อจำกัดตรงที่สามารถใช้งานได้เฉพาะ member ใน base class เท่านั้น
- เราสามารถใช้ virtual เพื่อเข้าถึงสมาชิกใน base class โดยใช้ reference ของ derived class ได้โดยตรง

### การใช้งาน Virtual and Override Methods
- method ของ base class และ derived class ต้องมี signature เหมือนกันทุกประการ ทั้งชนิดและจำนวนของพารามิเตอร์ รวมถึง return type
- method ใน base class ต้อง modify เป็น virtual
- method ใน derived class ต้อง modify เป็น override


### ข้อควรจำในการใช้ override modifier
- method ที่ override (อยู่ใน derived class) และ overridden (อยู่ใน base class) ต้องมี accessibility เดียวกัน เช่น ต้องเป็น public หรือ private เหมือนๆ กัน
- ไม่สามารถ override method ที่เป็น static
- ไม่สามารถ override method ที่ไม่ประกาศเป็น virtual
- สมาชิกของคลาสที่สามารถทำ override ได้  ได้แก่ Methods, properties,  indexers และ events

## Overriding a Method Marked override














